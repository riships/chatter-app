<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket.IO Frontend</title>
</head>

<body>
    <h1>Socket.IO Frontend</h1>
    <div id="status">Not connected</div>

    <input type="text" id="msgInput" placeholder="Enter Msg....">
    <button id="sendMsg">Send</button>
    <p style="margin: 0;padding: 0;" id="statusOfuser"></p>
    <div id="messages">

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        $(document).ready(function () {
            // Initialize Socket.IO connection variable
            let socket;

            // DOM Elements
            const status = $("#status");
            const msgInput = $("#msgInput")
            const sendMsgBtn = $("#sendMsg")
            const messagesContainer = $("#messages")
            const user = prompt("enter user")

            // Connect button click event

            socket = io();  // Connect to the server

            // When connected
            socket.on("connect", () => {
                console.log("Connected to server");
                status.text(`${user} Connected to server`);
                socket.emit('user', user)
            });


            sendMsgBtn.on('click', (event) => {
                event.preventDefault()
                if (msgInput.val()) {
                    socket.emit('send', msgInput.val())
                    msgInput.val('')
                    socket.emit('sendStatus', " ");
                }
            })
            msgInput.on('focus', (event) => {
                event.preventDefault()
                socket.emit('sendStatus', "Typing...")
            })

            socket.on('typing', (msg) => {
                if (msg) {
                    $("#statusOfuser").html(msg)
                }
            })
            socket.on('message', (msg) => {
                if (msg) {
                    let msgP = $('<p></p>');
                    msgP.html(msg)
                    messagesContainer.append(msgP)
                }
            })
        });
    </script>

</body>

</html>